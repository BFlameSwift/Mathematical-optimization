\newpage
\section{Problem 5.8}
\subsection{重要参数}
\[f({x_1},{x_2})=-9{x_1}-10{x_2}-\mu \left[\ln(-{x_1}-{x_2}+100)+\ln (-{x_1}+{x_2}+50)+\ln ({x_1})+\ln ({x_2})\right]\]



\begin{align}
\bm{g}(x_1, x_2) &= \nabla f(x_1, x_2)\nonumber\\
&=
\begin{bmatrix}
-9 -\dfrac{\mu}{x_1 }+\dfrac{\mu}{100 - x_1 - x_2} + \dfrac{\mu}{50 - x_1 + x_2} \nonumber\\
-10 - \dfrac{\mu}{x_2 }+\dfrac{\mu}{100 - x_1 - x_2} - \dfrac{\mu}{50 - x_1 + x_2}
\end{bmatrix}\nonumber\\\nonumber
\end{align}
\begin{align}
&\bm{G}[x_1, x_2] \nonumber\\
=& \nabla \bm{g}(x_1, x_2)\nonumber \\
=&
\begin{bmatrix}
\dfrac{1}{{x_1}^2 }+\dfrac{1}{(100 - x_1 - x_2)^2} + \dfrac{1}{(50 - x_1 + x_2)^2} 
&\dfrac{1}{(100 - x_1 - x_2)^2} - \dfrac{1}{(50 - x_1 + x_2)^2}\\
\dfrac{1}{(100 - x_1 - x_2)^2} - \dfrac{1}{(50 - x_1 + x_2)^2}&
\dfrac{1}{{x_2}^2 }+\dfrac{1}{(100 - x_1 - x_2)^2} + \dfrac{1}{(50 - x_1 + x_2)^2} 
\end{bmatrix}\nonumber\\ \nonumber
\end{align}

\subsection{算法伪代码}
\begin{algorithm}[h]  
\caption{Newton-Armijo method for problem(5.8)}  
\begin{algorithmic}[1]  
\STATE Given $\bm{x}^{(0)}$ and compute $\bm{g}(\bm{x})= \nabla f(\bm{x})$
\STATE Compute $\bm{G}(\bm{x})= \nabla {\bm{g}(\bm{x})}^T$
\STATE Set $\bm{g}^{(0)}=\bm{g}(\bm{x}^{(0)}),k=0$
\WHILE {$\|\bm{g}^{(k)}\|_2>\epsilon$}
\STATE Set $\bm{s}^{(k)}=-{\bm{G}^{(k)}}^{-1}\bm{g}^{(k)}$
\STATE Compute $\alpha_k$ by Backtracking-Armijo Line Search
\STATE Set $\bm{x}^{(k+1)}=\bm{x}^{(k)}+\alpha_k\bm{s}^{(k)}$
\STATE Set k=k+1
\ENDWHILE
\end{algorithmic}  
\end{algorithm} 

\subsection{计算结果展示}
\begin{figure}[H]
\centering
\includegraphics[width=11cm]{fig/5_1.pdf}
\end{figure}

\begin{figure}[H]
\centering
\includegraphics[width=11cm]{fig/5_2.pdf}
\end{figure}

\subsection{总结分析}
没加线搜索和越界判定之前，牛顿法总是一两次就冲到了定义域外，然后无法收敛。

然后我加了个越界判定:若下一步的迭代点不在定义域内，则将步长$\alpha$缩小一半，牛顿法很好地收敛到了全局最优点。

\begin{lstlisting}
%Check函数检查是否越界，以缩短步长ak
while(Check(x+ak*double(p')))
	ak=0.5*ak;
	xk=x+ak*double(p');
end
\end{lstlisting}

而后在越界判定的基础上加了个线搜索：

\begin{lstlisting}
%采用Armijo法则计算近似步长ak
while(F(xk(1),xk(2)) > (F(x(1),x(2))+0.01*double(p'*g)*ak)
||Check(x+ak*double(p')))%Check函数检查是否越界
	ak=0.5*ak;
	xk=x+ak*double(p');
end
\end{lstlisting}

然而得到的结果和没加线搜索一样，可见在迭代的前期，越界判定起到了一定类似于线搜索缩短步长的效果，而到了迭代的后期，已经牛顿法的基本步长已经满足Armijo法则，还原成了基本牛顿法。
