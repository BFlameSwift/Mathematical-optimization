
张晋第十二次作业15091060
-------

## 5.9

### 最速下降法

$\gamma$=0.9,$\rho$=0.01

#### 初始点:(1.2,1.2)

![Figure_1-2](C:\Users\80693\Desktop\Figure_1-2.png)

第 995 次迭代结果:
[ 1.05604686  1.11578718]
步长为:
0.00179701029991
第 996 次迭代结果:
[ 1.05626461  1.11558871]
步长为:
0.00179701029991
第 997 次迭代结果:
[ 1.05598175  1.11562688]
步长为:
0.00199667811102
第 998 次迭代结果:
[ 1.0562047   1.11541547]
步长为:
0.00179701029991
第 999 次迭代结果:
[ 1.05588661  1.11547042]

从图像可以看出，结果在最优解左右震荡，尽管接近最优解，但仍然未能很好收敛





#### 初始点:(-1.2,1)

![Figure_1-1](C:\Users\80693\Desktop\Figure_1-1.png)

第 995 次迭代结果:
[ 1.32340857  1.75425742]
步长为:
0.00117901845777
第 996 次迭代结果:
[ 1.32442297  1.75358604]
步长为:
0.00131002050864
第 997 次迭代结果:
[ 1.32321891  1.75371971]
步长为:
0.00117901845777
第 998 次迭代结果:
[ 1.32421119  1.75305677]
步长为:
0.00131002050864
第 999 次迭代结果:
[ 1.32302971  1.75318213]

迭代点初始运动得很快，但也和之前一样在最优解附近震荡，收敛很慢







### 牛顿法

$\gamma$=0.9,$\rho$=0.01

#### 初始点:(1.2,1.2)

![Figure_1-3](C:\Users\80693\Desktop\Figure_1-3.png)

第 1 次迭代结果:
[ 1.19591837  1.43020408]
步长为:
0.6561
第 2 次迭代结果:
[ 1.0678032   1.12378445]
步长为:
1
第 3 次迭代结果:
[ 1.05197555  1.10640204]
步长为:
1
第 4 次迭代结果:
[ 1.00247988  1.00251608]
步长为:
1
第 5 次迭代结果:
[ 1.00081549  1.00162887]
步长为:
1
第 6 次迭代结果:
[ 1.00000045  1.00000024]
步长为:
1
第 7 次迭代结果:
[ 1.  1.]



#### 初始点:(-1.2,1)

![Figure_1-4](C:\Users\80693\Desktop\Figure_1-4.png)

第 15 次迭代结果:
[ 0.90650146  0.82113373]
步长为:
1
第 16 次迭代结果:
[ 0.98981611  0.97279461]
步长为:
1
第 17 次迭代结果:
[ 0.99408025  0.98817735]
步长为:
1
第 18 次迭代结果:
[ 0.99997855  0.99992231]
步长为:
1
第 19 次迭代结果:
[ 0.99999985  0.9999997 ]
步长为:
1
第 20 次迭代结果:
[ 1.  1.]



可见牛顿法收敛得极快

```python
#-*- coding: UTF-8 -*-
"""
Newton法
Rosenbrock函数
函数 f(x)=100*(x(2)-x(1).^2).^2+(1-x(1)).^2
梯度 g(x)=(-400*(x(2)-x(1)^2)*x(1)-2*(1-x(1)),200*(x(2)-x(1)^2))^(T)
"""
rou=0.01
import numpy as np
import matplotlib.pyplot as plt
def F(x):
    return 100*(x[1]-x[0]**2)**2+(1-x[0])**2;

def jacobian(x):
    return np.array([-400*x[0]*(x[1]-x[0]**2)-2*(1-x[0]),200*(x[1]-x[0]**2)])

def hessian(x):
    return np.array([[-400*(x[1]-3*x[0]**2)+2,-400*x[0]],[-400*x[0],200]])

def phi(a,x,p):
    return F(x+a*p)


def Apha(x,p,g):
    a=1
    while(phi(a,x,p)>=F(x)+rou*np.dot(p.transpose(),g)*a):
        a=0.9*a
    return a

X1=np.arange(-1.5,2+0.05,0.05)
X2=np.arange(-3.5,3+0.05,0.05)
[x1,x2]=np.meshgrid(X1,X2)
f=100*(x2-x1**2)**2+(1-x1)**2; # 给定的函数
plt.contour(x1,x2,f,20) # 画出函数的20条轮廓线


def newton(x0):

    print('初始点为:')
    print(x0,'\n')
    W=np.zeros((2,10**3))
    i = 1
    imax = 1000
    W[:,0] = x0
    x = x0
    delta = 1
    alpha = 1

    while i<imax and delta>10**(-10):
        p = -np.dot(np.linalg.inv(hessian(x)),jacobian(x))
        #p=-jacobian(x)
        x0 = x
       # alpha=1.0*np.dot(jacobian(x).transpose(),jacobian(x))/np.dot((np.dot(jacobian(x).transpose(),hessian(x))),jacobian(x))
        alpha=Apha(x,p,jacobian(x))
        print('步长为:')
        print(alpha)
       # alpha=1.0
        x = x + alpha*p
        W[:,i] = x
        delta = sum((x-x0)**2)
        print('第 %d 次迭代结果:'%(i))
        print(x)
        i=i+1
    W=W[:,0:i]  # 记录迭代点
    return W

x0 = np.array([-1.2,1])
W=newton(x0)

plt.plot(W[0,:],W[1,:],'g*',W[0,:],W[1,:]) # 画出迭代点收敛的轨迹
plt.show()
```



## 5.19

```matlab
N=8;
G=ones(N,N);
b=ones(N,1);
x0=zeros(N,1);
for i= 1:N
    for j =1:N
         G(i,j) = 1/(i+j-1);
    end
end
    x = x0;
    g = G*x-b;
    p = -g;
    k = 0;
    while 1
        if norm(g, 2)<1e-6
            break
        end
        k = k + 1;
        
        d=G*p;
        a=(g'*g)/(p'*d);
        x = x+a*p;
        t=g+a*d;
       beta=(t'*t)/(g'*g);
       g=t;
       p=-g+beta*p;
    end
k
x
```

| n=5               | n=8                   | n=12              | n=20              |
| ----------------- | --------------------- | ----------------- | ----------------- |
| k=6               | k=19                  | k=35              | k=66              |
| x                 | x                     | x                 | x                 |
| 5.00000002066037  | 5.89856766292802e-11  | -9.60895537135449 | -10.9749126510893 |
| -120.000000009110 | -6.97176032007019e-11 | 815.396945500909  | 1050.92924583463  |
| 629.999999984204  | -5.15860286852761e-10 | -16496.5601423969 | -23956.2795083182 |
| -1120.00000001358 | 1.12339461172630e-09  | 135510.323445556  | 220425.673599387  |
| 629.999999984357  | 3.17065483551747e-10  | -536481.215700387 | -965346.669654001 |
|                   | -6.55028164772178e-10 | 1025399.39571366  | 1990103.06862559  |
|                   | -6.56530674556942e-10 | -642578.292665479 | -1252700.00760310 |
|                   | 4.58964570698870e-10  | -657590.976689034 | -1343474.30912827 |
|                   |                       | 804243.884701944  | 883233.066644487  |
|                   |                       | 663072.549158718  | 1687963.95092874  |
|                   |                       | -1241279.51532581 | 388212.758339880  |
|                   |                       | 465506.443773192  | -1305525.72041703 |
|                   |                       |                   | -1710545.71991628 |
|                   |                       |                   | -528251.066590642 |
|                   |                       |                   | 1208686.49124660  |
|                   |                       |                   | 2002890.86386703  |
|                   |                       |                   | 944594.155587335  |
|                   |                       |                   | -1434053.34920119 |
|                   |                       |                   | -2650953.30867554 |
|                   |                       |                   | 1887855.72260968  |

##  5.21

```matlab
N=4;
G=zeros(N,N);
b=[-1,0,2,5^(0.5)]
x0=zeros(N,1);
for i= 1:N
     G(i,i) = 2;
end

for i= 1:N-1
    G(i+1,i)=-1;
    G(i,i+1)=-1;
end
    x = x0;
    g = G*x-b;
    p = -g;
    k = 0;
    while 1
        if norm(g, 2)<1e-6
            break
        end
        k = k + 1;
        
        d=G*p;
        a=(g'*g)/(p'*d);

        x = x+a*p;
        t=g+a*d;
       beta=(t'*t)/(g'*g);
       g=t;
       p=-g+beta*p;
  
    end
```

k = 3，程序两次迭代之后就截止

g=[-2 ,-1 , 1.7639 , 2.4721 ]

Gg=[-3 ,-1.7639 , 2.0557 , 3.1803]

GGg=[-4.2361, -2.5836 , 2.6950 , 4.3050]



| n=5       | n=8       | n=12      | n=20      |
| --------- | --------- | --------- | --------- |
| k=6       | k=19      | k=35      | k=66      |
| x         | x         | x         | x         |
| 5.00E+00  | 5.90E-11  | -9.61E+00 | -1.10E+01 |
| -1.20E+02 | -6.97E-11 | 8.15E+02  | 1.05E+03  |
| 6.30E+02  | -5.16E-10 | -1.65E+04 | -2.40E+04 |
| -1.12E+03 | 1.12E-09  | 1.36E+05  | 2.20E+05  |
| 6.30E+02  | 3.17E-10  | -5.36E+05 | -9.65E+05 |
|           | -6.55E-10 | 1.03E+06  | 1.99E+06  |
|           | -6.57E-10 | -6.43E+05 | -1.25E+06 |
|           | 4.59E-10  | -6.58E+05 | -1.34E+06 |
|           |           | 8.04E+05  | 8.83E+05  |
|           |           | 6.63E+05  | 1.69E+06  |
|           |           | -1.24E+06 | 3.88E+05  |
|           |           | 4.66E+05  | -1.31E+06 |
|           |           |           | -1.71E+06 |
|           |           |           | -5.28E+05 |
|           |           |           | 1.21E+06  |
|           |           |           | 2.00E+06  |
|           |           |           | 9.45E+05  |
|           |           |           | -1.43E+06 |
|           |           |           | -2.65E+06 |
|           |           |           | 1.89E+06  |





x =

     0
     0
     0
     0


g =

   -1.0000
         0
    2.0000
    2.2361


x =

    0.9045
         0
   -1.8090
   -2.0225


x =

   -0.4472
   -1.8944
   -3.3416
   -2.7889





$$ \lef(\begin{array}{cccc}2 & -1 & 0 & 0 \\ -1 & 2 & -1 & 0 \\0 & -1 & 2 & -1 \\0 & 0 & -1 & 2 \\end{array}\right)$$

